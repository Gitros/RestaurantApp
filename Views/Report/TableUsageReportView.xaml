<UserControl x:Class="RestaurantApp.Views.TableUsageReportView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:shared="clr-namespace:RestaurantApp.Views.Shared">

	<shared:ListPageShell Title="Raport: obłożenie stolików"
                          CountText="{Binding FilteredCountText}">

		<!-- TOOLBAR -->
		<shared:ListPageShell.ToolbarContent>
			<Grid>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="260"/>
					<ColumnDefinition Width="12"/>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition Width="90"/>
					<ColumnDefinition Width="12"/>
					<ColumnDefinition Width="Auto"/>
					<ColumnDefinition Width="90"/>
					<ColumnDefinition Width="12"/>
					<ColumnDefinition Width="140"/>
					<ColumnDefinition Width="*"/>
					<ColumnDefinition Width="110"/>
					<ColumnDefinition Width="10"/>
					<ColumnDefinition Width="110"/>
					<ColumnDefinition Width="10"/>
					<ColumnDefinition Width="110"/>
					<ColumnDefinition Width="10"/>
					<ColumnDefinition Width="110"/>
				</Grid.ColumnDefinitions>

				<!-- Strefa -->
				<TextBox Grid.Column="0"
						 Height="28"
						 VerticalContentAlignment="Center"
						 Text="{Binding AreaFilter, UpdateSourceTrigger=PropertyChanged}"
						 ToolTip="Np. Sala, Ogródek, VIP..."/>

				<!-- Min zamówień -->
				<TextBlock Grid.Column="2" Text="Min zam." VerticalAlignment="Center"/>
				<TextBox Grid.Column="3"
						 Height="28"
						 VerticalContentAlignment="Center"
						 Text="{Binding MinOrders, UpdateSourceTrigger=PropertyChanged}"
						 ToolTip="0 = bez limitu"/>

				<!-- Min rezerwacji -->
				<TextBlock Grid.Column="5" Text="Min rez." VerticalAlignment="Center"/>
				<TextBox Grid.Column="6"
						 Height="28"
						 VerticalContentAlignment="Center"
						 Text="{Binding MinReservations, UpdateSourceTrigger=PropertyChanged}"
						 ToolTip="0 = bez limitu"/>

				<!-- Tylko aktywne -->
				<CheckBox Grid.Column="8"
						  Content="Tylko aktywne"
						  VerticalAlignment="Center"
						  IsChecked="{Binding OnlyActive}"/>

				<!-- Filtruj / Reset -->
				<Button Grid.Column="10" Content="Filtruj" Width="110" Command="{Binding FilterCommand}"/>
				<Button Grid.Column="12" Content="Reset" Width="110" Command="{Binding ResetCommand}"/>

				<!-- Szybkie filtry -->
				<Button Grid.Column="14" Content="Aktywne" Width="110" Command="{Binding QuickActiveCommand}"/>
				<Button Grid.Column="16" Content="Zam. ≥ 1" Width="110" Command="{Binding QuickHasOrdersCommand}"/>
			</Grid>
		</shared:ListPageShell.ToolbarContent>


		<!-- CONTENT -->
		<Grid>
			<Grid.RowDefinitions>
				<RowDefinition Height="Auto"/>
				<RowDefinition Height="*"/>
			</Grid.RowDefinitions>

			<!-- KAFELKI -->
			<UniformGrid Grid.Row="0" Columns="4" Margin="0,0,0,10">
				<Border Margin="0,0,10,0"
                        Padding="10"
                        CornerRadius="8"
                        Background="#FFF7F7F7"
                        BorderBrush="#22000000"
                        BorderThickness="1">
					<StackPanel>
						<TextBlock Text="Stoliki (po filtrze)" Foreground="Gray"/>
						<TextBlock Text="{Binding TotalTables}"
                                   FontSize="18"
                                   FontWeight="SemiBold"/>
					</StackPanel>
				</Border>

				<Border Margin="0,0,10,0"
                        Padding="10"
                        CornerRadius="8"
                        Background="#FFF7F7F7"
                        BorderBrush="#22000000"
                        BorderThickness="1">
					<StackPanel>
						<TextBlock Text="Zamówienia (po filtrze)" Foreground="Gray"/>
						<TextBlock Text="{Binding TotalOrders}"
                                   FontSize="18"
                                   FontWeight="SemiBold"/>
					</StackPanel>
				</Border>

				<Border Margin="0,0,10,0"
                        Padding="10"
                        CornerRadius="8"
                        Background="#FFF7F7F7"
                        BorderBrush="#22000000"
                        BorderThickness="1">
					<StackPanel>
						<TextBlock Text="Rezerwacje (po filtrze)" Foreground="Gray"/>
						<TextBlock Text="{Binding TotalReservations}"
                                   FontSize="18"
                                   FontWeight="SemiBold"/>
					</StackPanel>
				</Border>

				<Border Padding="10"
                        CornerRadius="8"
                        Background="#FFF7F7F7"
                        BorderBrush="#22000000"
                        BorderThickness="1">
					<StackPanel>
						<TextBlock Text="Przychód z zamówień" Foreground="Gray"/>
						<TextBlock Text="{Binding TotalRevenue, StringFormat={}{0:C}}"
                                   FontSize="18"
                                   FontWeight="SemiBold"/>
					</StackPanel>
				</Border>
			</UniformGrid>

			<!-- DATA + SZCZEGÓŁY -->
			<Grid Grid.Row="1">
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="3*"/>
					<ColumnDefinition Width="16"/>
					<ColumnDefinition Width="2*"/>
				</Grid.ColumnDefinitions>

				<DataGrid Grid.Column="0"
                          ItemsSource="{Binding RowsView}"
                          SelectedItem="{Binding SelectedRow}"
                          IsReadOnly="True"
                          CanUserSortColumns="True">
					<DataGrid.Columns>
						<DataGridTextColumn Header="ID" Binding="{Binding TableId}" Width="70"/>
						<DataGridTextColumn Header="Strefa" Binding="{Binding AreaName}" Width="*"/>
						<DataGridTextColumn Header="Stolik" Binding="{Binding TableName}" Width="120"/>
						<DataGridTextColumn Header="Miejsca" Binding="{Binding SeatsCount}" Width="90"/>
						<DataGridCheckBoxColumn Header="Aktywny" Binding="{Binding IsActive}" Width="80"/>
						<DataGridTextColumn Header="Zamówienia" Binding="{Binding OrdersCount}" Width="110"/>
						<DataGridTextColumn Header="Rezerwacje" Binding="{Binding ReservationsCount}" Width="110"/>
						<DataGridTextColumn Header="Suma (zam.)"
                                            Binding="{Binding OrdersRevenue, StringFormat=\{0:C\}}"
                                            Width="140"/>
					</DataGrid.Columns>
				</DataGrid>

				<Border Grid.Column="2"
                        Padding="12"
                        CornerRadius="8"
                        Background="#FFF7F7F7"
                        BorderBrush="#22000000"
                        BorderThickness="1">
					<StackPanel>
						<TextBlock Text="Szczegóły stolika"
                                   FontSize="16"
                                   FontWeight="SemiBold"
                                   Margin="0,0,0,10"/>

						<TextBlock Text="Strefa / stolik" Foreground="Gray"/>
						<TextBlock FontSize="14" Margin="0,0,0,8">
							<Run Text="{Binding SelectedRow.AreaName}"/>
							<Run Text=" — "/>
							<Run Text="{Binding SelectedRow.TableName}"/>
						</TextBlock>

						<TextBlock Text="Miejsca" Foreground="Gray"/>
						<TextBlock Text="{Binding SelectedRow.SeatsCount}"
                                   FontSize="14"
                                   Margin="0,0,0,8"/>

						<TextBlock Text="Zamówienia" Foreground="Gray"/>
						<TextBlock Text="{Binding SelectedRow.OrdersCount}"
                                   FontSize="14"
                                   Margin="0,0,0,2"/>
						<TextBlock Text="{Binding SelectedOrdersShareText}"
                                   Foreground="Gray"
                                   Margin="0,0,0,8"/>

						<TextBlock Text="Przychód z zamówień" Foreground="Gray"/>
						<TextBlock Text="{Binding SelectedRow.OrdersRevenue, StringFormat={}{0:C}}"
                                   FontSize="14"
                                   Margin="0,0,0,2"/>
						<TextBlock Text="{Binding SelectedRevenueShareText}"
                                   Foreground="Gray"
                                   Margin="0,0,0,8"/>

						<TextBlock Text="Rezerwacje" Foreground="Gray"/>
						<TextBlock Text="{Binding SelectedRow.ReservationsCount}"
                                   FontSize="14"/>
					</StackPanel>
				</Border>
			</Grid>
		</Grid>

	</shared:ListPageShell>
</UserControl>
